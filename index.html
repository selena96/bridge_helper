<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Bridge Helper - Mobile Friendly Quiz</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 10px;
  background: #f9f9f9;
}
h1 {text-align: center; font-size: 1.8em; margin-bottom: 20px;}
#home {text-align:center;}
.section-btn {
  display:block;
  margin:10px auto;
  padding:15px;
  width: 90%;
  max-width: 300px;
  font-size: 1em;
  background:#007bff;
  color:white;
  border:none;
  border-radius:6px;
}
.section-btn:hover {background:#0056b3;}
#quiz-container {display:none;}
.question {margin-bottom:20px;}
.option {
  padding:12px;
  margin:5px 0;
  border:1px solid #ccc;
  border-radius:6px;
  cursor:pointer;
  font-size:1em;
}
.option:hover {background:#e0f0ff;}
.selected {background:#d0ebff; border-color:#007bff;}
.feedback {margin-top:10px; padding:10px; border-radius:6px;}
.correct {background:#d4edda; border-left:4px solid #28a745;}
.incorrect {background:#f8d7da; border-left:4px solid #dc3545;}
#nextBtn {
  margin-top:15px;
  padding:12px;
  width: 50%;
  max-width:200px;
  display:block;
  margin-left:auto;
  margin-right:auto;
  font-size:1em;
  border:none;
  border-radius:6px;
  background:#28a745;
  color:white;
}
#nextBtn:disabled {background:#ccc; cursor:default;}
.progress {height:12px; background:#e0e0e0; border-radius:6px; margin-bottom:20px; overflow:hidden;}
.progress-bar {height:100%; background:#007bff; width:0%;}
#results {display:none; text-align:center;}
#score {font-size:1.2em; margin-bottom:15px;}
#retryBtn {padding:12px 20px; font-size:1em; border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;}
#retryBtn:hover {background:#0056b3;}
</style>
</head>
<body>

<h1>üÉè Bridge Helper</h1>

<div id="home">
  <h2>Select a Section</h2>
</div>

<div id="quiz-container">
  <div class="progress"><div class="progress-bar" id="progress-bar"></div></div>
  <div id="quiz"></div>
  <button id="nextBtn" disabled>Next</button>
</div>

<div id="results">
  <h2>Results</h2>
  <p id="score"></p>
  <button id="retryBtn">Retry Section</button>
</div>

<script>
let questionBank = {};
let currentSection = "";
let questions = [];
let currentIndex = 0;
let selectedOption = null;
let score = 0;

const home = document.getElementById("home");
const quizContainer = document.getElementById("quiz-container");
const results = document.getElementById("results");
const quizDiv = document.getElementById("quiz");
const nextBtn = document.getElementById("nextBtn");
const progressBar = document.getElementById("progress-bar");
const scoreText = document.getElementById("score");
const retryBtn = document.getElementById("retryBtn");

// Fetch questions from JSON
fetch("questions.json")
.then(response => response.json())
.then(data => {
  questionBank = data;
  for (let section in questionBank) {
    const btn = document.createElement("button");
    btn.className = "section-btn";
    btn.innerText = section;
    btn.dataset.section = section;
    btn.addEventListener("click", () => {
      currentSection = section;
      startSection();
    });
    home.appendChild(btn);
  }
});

function startSection(){
  home.style.display = "none";
  results.style.display = "none";
  quizContainer.style.display = "block";
  questions = questionBank[currentSection];
  currentIndex = 0;
  score = 0;
  loadQuestion();
}

function loadQuestion(){
  const q = questions[currentIndex];
  quizDiv.innerHTML = `<div class="question"><p>${q.question}</p>` +
    q.options.map((opt,i)=>`<div class="option" data-index="${i}">${opt}</div>`).join("") +
    `</div><div id="feedback" class="feedback hidden"></div>`;
  selectedOption = null;
  nextBtn.disabled = true;
  updateProgress();

  document.querySelectorAll(".option").forEach(opt=>{
    opt.addEventListener("click",()=>{
      document.querySelectorAll(".option").forEach(o=>o.classList.remove("selected"));
      opt.classList.add("selected");
      selectedOption = parseInt(opt.dataset.index);
      showFeedback();
      nextBtn.disabled = false;
    });
  });
}

function showFeedback(){
  const feedback = document.getElementById("feedback");
  if(selectedOption === questions[currentIndex].correct){
    feedback.innerText = "‚úÖ Correct!";
    feedback.className = "feedback correct";
    score++;
  } else {
    feedback.innerText = "‚ùå Incorrect!";
    feedback.className = "feedback incorrect";
  }
  feedback.classList.remove("hidden");
}

nextBtn.addEventListener("click",()=>{
  currentIndex++;
  if(currentIndex < questions.length) loadQuestion();
  else showResults();
});

function showResults(){
  quizContainer.style.display = "none";
  results.style.display = "block";
  scoreText.innerText = `You scored ${score} / ${questions.length} in ${currentSection}`;
}

retryBtn.addEventListener("click", startSection);

function updateProgress(){
  const percent = (currentIndex / questions.length) * 100;
  progressBar.style.width = percent + "%";
}
</script>

</body>
</html>
